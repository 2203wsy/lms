{extends file="layout.html"}
{block name=title}LMS: {$layout.pagetitle|striphtml}{/block}
{block name=module_content}
<!-- $Id$ -->
<H1>{$layout.pagetitle}</H1>

<TABLE class="lmsbox lms-ui-background-cycle lms-ui-multi-check">
    <COLGROUP>
        <COL style="width: 1%;">
        <COL style="width: 1%;">
        <COL style="width: 1%;">
        <COL style="width: 1%;">
        <COL style="width: 50%;">
        <COL style="width: 45%;">
        <COL style="width: 1%;">
        <COL style="width: 1%;">
        <COL style="width: 1%;">
        <COL style="width: 1%;">
    </COLGROUP>
    <THEAD>
        {include file="rt/rtfilter.html"}
        <TR>
            <TD class="lms-ui-pagination" COLSPAN="9">
                {if $pagination->getTotal() != 0}
                {include file="pagination.html"}
                {/if}
            </TD>
            <TD class="lms-ui-pagination text-right nobr">
                <label>
                    <input type="checkbox" class="lms-ui-multi-check-all">
                    {trans("Check all")}
                </label>
                <a href="#" class="group-message-reply"><img src="img/forward.gif" alt=""> {trans("Group message reply")}</a>
                <A HREF="?m=rtticketadd{if isset($filter.ids) && (!is_array($filter.ids) || count($filter.ids) == 1)}&id={$filter.ids[0]}{/if}"><IMG src="img/save.gif" ALT=""> {trans("Create")}</A>
            </TD>
        </TR>
        {include file="rt/rtheader.html"}
    </THEAD>
    <TBODY>
        {include file="rt/rtqueueviewbox.html"}
    </TBODY>
    <TFOOT>
        <TR>
            <TD class="lms-ui-pagination" COLSPAN="9">
                {if $pagination->getTotal() != 0}
                {include file="pagination.html"}
                {/if}
            </TD>
            <TD class="lms-ui-pagination text-right nobr">
                <label>
                    <input type="checkbox" class="lms-ui-multi-check-all">
                    {trans("Check all")}
                </label>
                <a href="#" class="group-message-reply"><img src="img/forward.gif" alt=""> {trans("Group message reply")}</a>
                <A HREF="?m=rtticketadd{if isset($filter.ids) && (!is_array($filter.ids) || count($filter.ids) == 1)}&id={$filter.ids[0]}{/if}"><IMG src="img/save.gif" ALT=""> {trans("Create")}</A>
            </TD>
        </TR>
    </TFOOT>
</TABLE>
<script>

	$(function() {
		function disableLink() {
			var disabled = $('.lms-ui-multi-check:checked').length < 2;
			if (disabled) {
				$('.group-message-reply').addClass('disabled');
			} else {
				$('.group-message-reply').removeClass('disabled');
			}
		};
		disableLink();

		$('.lms-ui-multi-check:checkbox,.lms-ui-multi-check-all:checkbox').click(function () {
			disableLink();
		});

		$('.group-message-reply').click(function () {
			if ($(this).is('.disabled')) {
				return false;
			}
			var ticketid = [];
			$('[name="ticketid[]"]:checked').each(function () {
				ticketid.push($(this).val());
			});
			location.href = '?m=rtmessageadd&ticketid[]=' + ticketid.join('&ticketid[]=');
		});
	});

</script>
{/block}
