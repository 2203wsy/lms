{extends file="layout.html"}
{block name=title}LMS: {$layout.pagetitle|striphtml}{/block}
{block name=module_content}
<!-- $Id$ -->
<H1>{$layout.pagetitle}</H1>
<TABLE class="lmsbox lms-ui-background-cycle lms-ui-multi-check">
	<COLGROUP>
		<COL style="width: 1%;">
		<COL style="width: 1%;">
		<COL style="width: 1%;">
		<COL style="width: 1%;">
		<COL style="width: 50%;">
		<COL style="width: 45%;">
		<COL style="width: 1%;">
		<COL style="width: 1%;">
		<COL style="width: 1%;">
		<COL style="width: 1%;">
	</COLGROUP>
    <THEAD>
	{include file="rt/rtheader.html"}
	<TR>
		<TD class="lms-ui-pagination" colspan="9">
			{if $pagination->getTotal() != 0}
			{include file="pagination.html"}
			{/if}
		</TD>
		<TD class="text-right nobr">
			<label>
				<input type="checkbox" class="lms-ui-multi-check-all">
				{trans("Check all")}
			</label>
			<a href="javascript:void(0)" class="group-message-reply"><img src="img/forward.gif" alt=""> {trans("Group message reply")}</a>
			<A HREF="?m=rtticketadd{if $queuedata.queue && !is_array($queuedata.queue)}&id={$queuedata.queue}{/if}&customerid={$filter.custid}">{trans("New Ticket")} <IMG src="img/save.gif" ALT=""></A>
		</TD>
	</TR>
    </THEAD>
    <TBODY>
	{include file="rt/rtqueueviewbox.html"}
    </TBODY>
	<TFOOT>
	<TR>
		<TD class="lms-ui-pagination" colspan="9">
			{if $pagination->getTotal() != 0}
			{include file="pagination.html"}
			{/if}
		</TD>
		<TD class="text-right dark nobr">
			<label>
				<input type="checkbox" class="lms-ui-multi-check-all">
				{trans("Check all")}
			</label>
			<a href="javascript:void(0)" class="group-message-reply"><img src="img/forward.gif" alt=""> {trans("Group message reply")}</a>
			<A HREF="?m=rtticketadd{if $queuedata.queue && !is_array($queuedata.queue)}&id={$queuedata.queue}{/if}&customerid={$filter.custid}">{trans("New Ticket")} <IMG src="img/save.gif" ALT=""></A>
		</TD>
	</TR>
	</TFOOT>
</TABLE>
<script>

	$(function() {
		$('.lms-ui-multi-check:checkbox,.lms-ui-multi-check-all:checkbox').click(function () {
			var disabled = $('.lms-ui-multi-check:checked').length < 2;
			if (disabled) {
				$('.group-message-reply').addClass('disabled');
			} else {
				$('.group-message-reply').removeClass('disabled');
			}
		}).first().click();

		$('.group-message-reply').on('click', ':not(.disabled)', function (e) {
			var ticketid = [];
			$('[name="ticketid[]"]:checked').each(function () {
				ticketid.push($(this).val());
			});
			location.href = '?m=rtmessageadd&ticketid[]=' + ticketid.join('&ticketid[]=');
		});
	});

</script>
{/block}
